!function(){function set_plot_size(plot_id,width_mult=1,height_mult=.8,legend_mult=1){const get_size=plot_id=>function(plot_id,width_mult,height_mult,legend_mult){var parentNode=document.getElementById(plot_id).parentNode,vw=width_mult*Math.max(parentNode.clientWidth||0,parentNode.innerWidth||0),vh=(Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),height_mult*vw);return vw<650?{width:vw,height:1.4*vw,legend:{orientation:"h",y:legend_mult*(.02515089*vw-4.37961-508202e-10*Math.pow(vw,2)+3.40451e-8*Math.pow(vw,3))}}:{width:vw,height:vh,legend:{orientation:"v",y:1}}}(plot_id,width_mult,height_mult,legend_mult);return function(plot_id,get_size_func){window.addEventListener("resize",(function(){Plotly.relayout(plot_id,get_size_func(plot_id))}))}(plot_id,get_size),get_size(plot_id)}function get_column(rows,key){return rows.map((function(row){return row[key]}))}function round(val,digits=4){"string"==typeof val&&(val=Number.parseFloat(val));var mult=10**digits;return Math.round((val+Number.EPSILON)*mult)/mult}Plotly.newPlot("LinearProgram",[{x:[0,1,2,3],y:[10,5,0,-5],type:"scatter",mode:"lines",name:"5p + b <= s"},{x:[-1,0,1,2.5],y:[5,5,5,5],type:"scatter",mode:"lines",name:"b <= 5"},{x:[0,0,0,0],y:[-2,0,5,8],type:"scatter",mode:"lines",name:"p >= 0"},{x:[-1,0,2,2.5],y:[0,0,0,0],type:"scatter",mode:"lines",name:"b >= 0"},{x:[-1,0,2,2.5],y:[9,7,3,2],type:"scatter",mode:"lines",name:"2p + b = 7<br>Dual Solution",visible:"legendonly"}],{...set_plot_size("LinearProgram",width_mult=1,height_mult=.5,legend_mult=.8),margin:{l:40,r:40,b:40,t:40,pad:0},showlegend:!0,xaxis:{range:[-1,2.5],title:{text:"p"}},yaxis:{range:[-2,8],title:{text:"b"}},shapes:[{type:"path",path:"M0,0 L0,5 L1,5 L2,0 Z",fillcolor:"rgba(255, 140, 184, 0.5)",line:{width:0}}],annotations:[{x:1,y:5,text:"<b>2 x 1 + 5 = 7</b>",showarrow:!0,ax:30},{x:0,y:5,text:"2 x 0 + 5 = 5",showarrow:!0,ax:-40,ay:-45},{x:2,y:0,text:"2 x 2 + 0 = 4",showarrow:!0,ax:40,ay:-25}]},{scrollZoom:!1,displayModeBar:!1});d3.csv("../plotdata/uni-iso-regression.csv",(function(err,rows){d3.csv("../plotdata/uni-iso-regression-iterations.csv",(function(err,rows_anim){var iterations={},slider_steps=[],frames=[];function get_label(iter){return"Loss: "+round(iterations[iter].loss)}for(var i=0;i<rows_anim.length;i++){var trace,group,row=rows_anim[i];if((trace=iterations[row.iter])||(trace=iterations[row.iter]={x:[],y:[],groups:{}}),trace.x.push(row.X_1),trace.y.push(row.y_fit),row.L2&&(trace.loss=row.L2),row.group_loss)(group=trace.groups[row.group]={}).loss=round(row.group_loss,3),group.x=Number.parseFloat(row.X_1),group.y=-.4;else(group=trace.groups[row.group]).x=(Number.parseFloat(row.X_1)+group.x)/2}function get_values(obj,subkey){var result=[];for(key of Object.keys(obj))result.push(obj[key][subkey]);return result}for(iter of Object.keys(iterations))slider_steps.push({method:"animate",label:iter,args:[[iter],{mode:"immediate",transition:{duration:300},frame:{duration:300}}]});for(iter of Object.keys(iterations)){var data=[];data[1]={x:iterations[iter].x.slice(),y:iterations[iter].y.slice()},data[3]={x:get_values(iterations[iter].groups,"x"),y:get_values(iterations[iter].groups,"y"),text:Object.keys(iterations[iter].groups)};var prev_x=!1,down=!1,idx=0,loss_text_x=get_values(iterations[iter].groups,"x"),loss_text_y=loss_text_x.map((x=>[x,idx++])).sort(((a,b)=>a[0]-b[0])).map((function(row){return(down||prev_x&&Math.abs(row[0]-prev_x)<2)&&(down=!down),prev_x=row[0],[row[1],down?-1.3:-.9]})).sort(((a,b)=>a[0]-b[0])).map((row=>row[1]));data[4]={x:loss_text_x,y:loss_text_y,text:get_values(iterations[iter].groups,"loss")},frames.push({name:iter,data:data,layout:{"annotations[0].text":get_label(iter),"sliders[0].active":iter}})}Plotly.newPlot("UniIsoPlot",{data:[{x:get_column(rows,"X_1"),y:get_column(rows,"y"),type:"scatter",mode:"markers",name:"Observations"},{x:iterations[3].x.slice(),y:iterations[3].y.slice(),line:{shape:"hvh"},type:"scatter",mode:"lines",name:"Isotonic Regression (L2)"},{x:get_column(rows,"X_1"),y:get_column(rows,"L2"),type:"scatter",mode:"lines",name:"Linear Regression (L2)",visible:"legendonly"},{x:get_values(iterations[3].groups,"x"),y:get_values(iterations[3].groups,"y"),text:Object.keys(iterations[3].groups),type:"scatter",mode:"text",name:"Group",textfont:{color:"#803a36"}},{x:get_values(iterations[3].groups,"x"),y:get_values(iterations[3].groups,"y").map((function(val){return-.9})),text:get_values(iterations[3].groups,"loss"),type:"scatter",mode:"text",name:"Group Loss",textfont:{color:"#807d7d"}}],layout:{...set_plot_size("UniIsoPlot",width_mult=1,height_mult=.6),margin:{l:20,r:20,b:20,t:20,pad:0},showlegend:!0,xaxis:{range:[0,31]},yaxis:{range:[-1.5,9.5]},annotations:[{xref:"paper",yref:"paper",x:.1,xanchor:"left",y:.9,yanchor:"bottom",text:get_label(3),font:{size:19},showarrow:!1}],sliders:[{pad:{l:130,t:55},currentvalue:{visible:!1},steps:slider_steps,active:3}],updatemenus:[{x:0,y:0,yanchor:"top",xanchor:"left",showactive:!0,active:1,direction:"left",type:"buttons",pad:{t:50,r:10},buttons:[{method:"animate",args:[null,{mode:"immediate",fromcurrent:!0,transition:{duration:300},frame:{duration:1e3}}],label:"Play"},{method:"animate",args:[[null],{mode:"immediate",transition:{duration:0},frame:{duration:0}}],label:"Pause"}]}]},config:{scrollZoom:!1,displayModeBar:!1},frames:frames})}))})),multi_iso_plot="MultiIsoPlot",d3.csv("../plotdata/multi-iso-regression.csv",(function(err,rows){d3.csv("../plotdata/multi-iso-regression-iterations.csv",(function(err,rows_anim){var iterations={},slider_steps=[],frames=[];function get_label(iter){return"Iteration: "+iter+"<br>Loss: "+round(iterations[iter].loss)}var x=Array.from(new Set(get_column(rows,"X_1"))),y=Array.from(new Set(get_column(rows,"X_2"))),z_reg=[];for(j=0;j<y.length;j++)z_reg.push([]);for(i=0;i<x.length;i++)for(j=0;j<y.length;j++)z_reg[j].push(rows[i*y.length+j].L2);for(var rows_anim_idx=0,iter=0;!(rows_anim_idx>=rows_anim.length);){var z_iso=[];for(j=0;j<y.length;j++)z_iso.push([]);for(i=0;i<x.length;i++)for(j=0;j<y.length;j++)z_iso[j].push(rows_anim[rows_anim_idx+i*y.length+j].y_fit);iterations[iter]={x:x.slice(),y:y.slice(),z:z_iso,loss:rows_anim[rows_anim_idx].L2},iter++,rows_anim_idx+=x.length*y.length}for(iter of Object.keys(iterations))slider_steps.push({method:"animate",label:iter,args:[[iter],{mode:"immediate",transition:{duration:300},frame:{duration:300}}]});for(iter of Object.keys(iterations)){var data=[];data[1]={z:iterations[iter].z.slice()},frames.push({name:iter,data:data,layout:{"annotations[0].text":get_label(iter),"sliders[0].active":iter}})}Plotly.newPlot(multi_iso_plot,{data:[{x:get_column(rows,"X_1"),y:get_column(rows,"X_2"),z:get_column(rows,"y"),mode:"markers",marker:{size:1,color:"rgb(0, 0, 0)",opacity:.8},type:"scatter3d",name:"Observations"},{x:iterations[7].x,y:iterations[7].y,z:iterations[7].z,type:"surface",showscale:!1,opacity:.7,colorscale:"YlOrRd",name:"Isotonic Regression (L2)",showlegend:!0},{x:x,y:y,z:z_reg,type:"surface",showscale:!1,opacity:.7,colorscale:"Greens",name:"Linear Regression (L2)",visible:"legendonly",showlegend:!0}],layout:{...set_plot_size(multi_iso_plot,width_mult=1,height_mult=.6),margin:{l:20,r:20,b:20,t:20,pad:0},scene:{camera:{eye:{x:-.4,y:-1.6,z:.6},center:{x:0,y:0,z:-.15}},xaxis:{range:[0,20]},yaxis:{range:[0,20]},zaxis:{range:[0,15]}},showlegend:!0,annotations:[{xref:"paper",yref:"paper",x:1.03,xanchor:"left",y:.5,yanchor:"bottom",align:"left",text:get_label(7),font:{size:19},showarrow:!1}],sliders:[{pad:{l:130,t:55},currentvalue:{visible:!1},steps:slider_steps,active:7}],updatemenus:[{x:0,y:0,yanchor:"top",xanchor:"left",showactive:!0,active:1,direction:"left",type:"buttons",pad:{t:50,r:10},buttons:[{method:"animate",args:[null,{mode:"immediate",fromcurrent:!0,transition:{duration:300},frame:{duration:1e3}}],label:"Play"},{method:"animate",args:[[null],{mode:"immediate",transition:{duration:0},frame:{duration:0}}],label:"Pause"}]}]},config:{displayModeBar:!1},frames:frames})}))})),function(){const parentNode=document.getElementById("AdjacencyMatrix").parentNode;function get_font_size(vw){return vw<=450?"12px":"none"}function get_stroke_width(vw){return vw<=450?1.3:2}function build_adjacency_diagram(){var animation_state=0;const width=Math.max(parentNode.clientWidth||0,parentNode.innerWidth||0),height=(vw=width)<=450?vw:.6*vw;var vw;d3.select("#AdjacencyMatrix").select("svg").remove();const svg=d3.select("#AdjacencyMatrix").append("svg").attr("width",width+"px").attr("height",height+"px"),points=[{x:2*width/9,y:2*height/9,text:"(1, 1)"},{x:3*width/9,y:3*height/9,text:"(1, 1)"},{x:4*width/9,y:4*height/9,text:"(3, 1)"},{x:5*width/9,y:5*height/9,text:"(1, 3)"},{x:6*width/9,y:6*height/9,text:"(2, 3)"},{x:7*width/9,y:7*height/9,text:"(3, 3)"}],links=[{source:0,dest:1,dir:!0},{source:1,dest:0,dir:!0,rev:!0},{source:1,dest:2,dir:!0},{source:1,dest:3,dir:!0},{source:2,dest:5,dir:!1},{source:3,dest:4,dir:!0},{source:4,dest:5,dir:!0}];for(c of(svg.append("svg:defs").append("svg:marker").attr("id","arrow").attr("viewBox","0 0 10 10").attr("refX",0).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z"),["pointHoriz","pointVert"]))svg.selectAll(c).data(points).enter().append("text").attr("class",c).attr("x",(d=>d.x)).attr("y",(d=>d.y)).text((d=>d.text)).attr({"text-anchor":"middle","dominant-baseline":"middle","font-size":get_font_size(width)});svg.selectAll("links").data(links).enter().append("path").attr("class","link").attr("d",(function(d){return op=d.rev?(a,b)=>a-b:(a,b)=>a+b,d.dir?d3.svg.line()([[op(points[d.source].x,width<=450?35/1.5:35),points[d.source].y],[points[d.dest].x,points[d.source].y],[points[d.dest].x,op(points[d.dest].y,-25)]]):d3.svg.line()([[points[d.source].x,op(points[d.source].y,15)],[points[d.source].x,points[d.dest].y],[op(points[d.dest].x,-35),points[d.dest].y]])})).attr({stroke:"black","stroke-width":get_stroke_width(width),fill:"none","marker-end":"url(#arrow)"});var matrixcontents=[];for(i=0;i<points.length;i++)for(j=0;j<points.length;j++)matrixcontents.push({x:(i+2)/9*width,y:(j+2)/9*height,text:"0"});for(link of links){var{source:source,dest:dest}=link;matrixcontents[source+points.length*dest].text="1"}svg.selectAll("matrixborder").data([[[1.7/9*width,1.5/9*height],[1.5/9*width,1.5/9*height],[1.5/9*width,7.5/9*height],[1.7/9*width,7.5/9*height]],[[7.3/9*width,1.5/9*height],[7.5/9*width,1.5/9*height],[7.5/9*width,7.5/9*height],[7.3/9*width,7.5/9*height]]]).enter().append("path").attr("class","matrixborder").attr("d",(d=>d3.svg.line()(d))).attr({stroke:"black","stroke-width":0,fill:"none"}),svg.selectAll("matrixcontents").data(matrixcontents).enter().append("text").attr("class","matrixcontents").attr("x",(d=>d.x)).attr("y",(d=>d.y)).text((d=>d.text)).attr({"text-anchor":"middle","dominant-baseline":"middle",visibility:"hidden","font-size":get_font_size(width)});var button_group=svg.selectAll("button-group").data([[{x:-81,width:70,height:33,text:"Graph",state:0,selected:!0}],[{x:36,width:160,height:33,text:"Adjacency Matrix",state:1,selected:!1}]]).enter().append("g").attr("class","button-group").attr("transform",(d=>"translate("+(width/2-d[0].width/2+d[0].x)+","+(height-33-2)+")")).on("click",(d=>{return button=d[0],void((chosen_state=button.state)!=animation_state&&(animation_state=chosen_state,button_group.selectAll(".button").transition().attr("fill",(d=>d.state==chosen_state?"#f4faff":"#ffffff")),0==chosen_state?(d3.selectAll(".pointHoriz").transition().attr("x",(d=>d.x)).duration(2e3).delay(500),d3.selectAll(".pointVert").transition().attr("y",(d=>d.y)).duration(2e3).delay(500),d3.selectAll(".link").transition().attr("stroke-width",2).duration(2500).delay(2e3),d3.selectAll(".matrixborder").transition().attr("stroke-width",0).duration(500),d3.selectAll(".matrixcontents").transition().attr("visibility","hidden").duration(500)):1==chosen_state&&(d3.selectAll(".pointHoriz").transition().attr("x",1/9*width).duration(2e3).delay(500),d3.selectAll(".pointVert").transition().attr("y",1/9*height).duration(2e3).delay(500),d3.selectAll(".link").transition().attr("stroke-width",0).duration(700),d3.selectAll(".matrixborder").transition().attr("stroke-width",2*get_stroke_width(width)).duration(2500).delay(2e3),d3.selectAll(".matrixcontents").transition().attr("visibility","visible").delay(2500))));var button,chosen_state})).on({mouseover:function(d){d3.select(this).style("cursor","pointer")},mouseout:function(d){d3.select(this).style("cursor","default")}});button_group.selectAll("button").data((d=>d)).enter().append("rect").attr("class","button").attr("fill",(d=>d.selected?"#f4faff":"#ffffff")).attr("width",(d=>d.width)).attr("height",(d=>d.height)).attr({rx:2,ry:2,stroke:"#bec8d9","stroke-opacity":1,"fill-opacity":1,"stroke-width":"1px","shape-rendering":"crispEdges"}),button_group.selectAll("buttontext").data((d=>d)).enter().append("text").attr("class","buttontext").attr("dx",(d=>d.width/2)).attr("dy",(d=>d.height/2)).text((d=>d.text)).attr({"text-anchor":"middle","dominant-baseline":"middle"})}build_adjacency_diagram(),window.addEventListener("resize",build_adjacency_diagram)}()}();
